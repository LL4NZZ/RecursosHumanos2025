{% extends base %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Mis Encuestas Asignadas</h2>
        {% if encuestas.pendientes %}
        <span class="badge bg-danger fs-5">Pendientes: {{ total_pendientes }}</span>
        {% else %}
        <span class="badge bg-success fs-5">¡Todo al día!</span>
        {% endif %}
    </div>

    <ul class="nav nav-tabs mb-3" id="encuestasTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="pendiente-tab" data-bs-toggle="tab" data-bs-target="#pendiente" type="button" role="tab" aria-controls="pendiente" aria-selected="true">
                Pendientes ({{ encuestas.pendientes|length }})
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="curso-tab" data-bs-toggle="tab" data-bs-target="#curso" type="button" role="tab" aria-controls="curso" aria-selected="false">
                En Curso ({{ encuestas.en_curso|length }})
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="completada-tab" data-bs-toggle="tab" data-bs-target="#completada" type="button" role="tab" aria-controls="completada" aria-selected="false">
                Completadas ({{ encuestas.completadas|length }})
            </button>
        </li>
    </ul>

    <div class="tab-content" id="encuestasTabContent">
        
        <div class="tab-pane fade show active" id="pendiente" role="tabpanel" aria-labelledby="pendiente-tab">
            {% if encuestas.pendientes %}
                {% for encuesta in encuestas.pendientes %}
                    {% include 'encuestas/_card_encuesta.html' %} 
                {% endfor %}
            {% else %}
                <div class="alert alert-info text-center">No tienes encuestas pendientes por iniciar. ¡Bien hecho!</div>
            {% endif %}
        </div>
        
        <div class="tab-pane fade" id="curso" role="tabpanel" aria-labelledby="curso-tab">
            {% if encuestas.en_curso %}
                {% for encuesta in encuestas.en_curso %}
                    {% include 'encuestas/_card_encuesta.html' %} 
                {% endfor %}
            {% else %}
                <div class="alert alert-secondary text-center">No tienes encuestas en curso.</div>
            {% endif %}
        </div>
        
        <div class="tab-pane fade" id="completada" role="tabpanel" aria-labelledby="completada-tab">
            {% if encuestas.completadas %}
                {% for encuesta in encuestas.completadas %}
                    {% include 'encuestas/_card_encuesta.html' %} 
                {% endfor %}
            {% else %}
                <div class="alert alert-success text-center">No hay encuestas completadas aún.</div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}