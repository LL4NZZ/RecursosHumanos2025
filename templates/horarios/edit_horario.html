{% extends 'base_admin.html' %}

{% block title %}Editar Horario{% endblock %}
{% block page_title %}✏️ Editar Horario{% endblock %}
{% block page_subtitle %}Modifica la asignación de horario para el usuario seleccionado.{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-lg p-4">
                <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-3">
                    <h3 class="m-0 fw-bold text-warning">{{ horario.Nombres }} {{ horario.Apellidos }}</h3>
                    <a href="{{ url_for('lista_horarios') }}" class="btn btn-outline-secondary">
                        <i class="fa-solid fa-arrow-left me-2"></i> Volver a la Lista
                    </a>
                </div>
                
                <form action="{{ url_for('edit_horario', id=horario.IdHorario) }}" method="POST">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    
                    <input type="hidden" name="IdUsuario" value="{{ horario.IdUsuario }}">
                    
                    <div class="row mb-4">
                        <div class="col-12">
                            <label class="form-label fw-semibold">Usuario Asignado</label>
                            <p class="form-control-plaintext text-dark fw-bold border p-2 bg-light rounded">
                                <i class="fa-solid fa-user-tag me-2 text-primary"></i>
                                {{ horario.Nombres }} {{ horario.Apellidos }}
                            </p>
                        </div>
                    </div>
                    
                    <hr>

                    <h6 class="text-secondary mb-3">Vigencia del Horario</h6>
                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <label for="fechaInicio" class="form-label">Fecha Inicio</label>
                            <input type="date" class="form-control" id="fechaInicio" name="FechaInicio" 
                                   value="{{ horario.FechaInicio }}" required>
                        </div>
                        <div class="col-md-6">
                            <label for="fechaFin" class="form-label">Fecha Fin</label>
                            <input type="date" class="form-control" id="fechaFin" name="FechaFin" 
                                   value="{{ horario.FechaFin }}" required>
                        </div>
                    </div>

                    <h6 class="text-secondary mb-3">Tiempos Laborales</h6>
                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <label for="horaEntradaP" class="form-label">Hora Entrada Programada</label>
                            <input type="time" class="form-control" id="horaEntradaP" name="HoraEntradaP" 
                                   value="{{ horario.HoraEntradaP }}" required>
                        </div>
                        <div class="col-md-6">
                            <label for="horaSalidaP" class="form-label">Hora Salida Programada</label>
                            <input type="time" class="form-control" id="horaSalidaP" name="HoraSalidaP" 
                                   value="{{ horario.HoraSalidaP }}" required>
                        </div>
                    </div>

                    <h6 class="text-secondary mb-3">Detalles Adicionales</h6>
                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <label for="descansoP" class="form-label">Descanso (en minutos)</label>
                            <input type="number" class="form-control" id="descansoP" name="DescansoP" 
                                   value="{{ horario.DescansoP | default(0) }}" required min="0">
                        </div>
                        <div class="col-md-6">
                            <label for="tipoJornada" class="form-label">Tipo de Jornada</label>
                            {% set jornada_actual = horario.TipoJornada %}
                            <select class="form-select" id="tipoJornada" name="TipoJornada" required>
                                <option value="" disabled>-- Selecciona una opción --</option>
                                <option value="Tiempo Completo" {% if jornada_actual == 'Tiempo Completo' %}selected{% endif %}>Tiempo Completo</option>
                                <option value="Medio Tiempo" {% if jornada_actual == 'Medio Tiempo' %}selected{% endif %}>Medio Tiempo</option>
                                <option value="Turno Nocturno" {% if jornada_actual == 'Turno Nocturno' %}selected{% endif %}>Turno Nocturno</option>
                                <option value="Turno Rotativo" {% if jornada_actual == 'Turno Rotativo' %}selected{% endif %}>Turno Rotativo</option>
                            </select>
                        </div>
                    </div>

                    <div class="d-flex justify-content-end gap-2 mt-5 border-top pt-3">
                        <button type="submit" class="btn btn-warning btn-lg">
                            <i class="fa-solid fa-sync-alt me-2"></i> Actualizar Horario
                        </button>
                        <a href="{{ url_for('lista_horarios') }}" class="btn btn-secondary btn-lg">
                            <i class="fa-solid fa-times me-2"></i> Cancelar
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}